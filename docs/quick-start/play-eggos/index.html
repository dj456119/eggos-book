<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="体验eggos #  上一节我们通过ISO镜像启动了eggos系统。
启动eggos成功后，我们就可以体验一些内置功能了。默认情况下有个类似linux的终端界面，在这个终端界面下我们可以输入命令来操作eggos。
这一节我们来体验下eggos的一些功能。
Javascript解释器 #  输入如下命令来启动交互式Javascript解释器
$ js 之后我们就可以输入合法的Javascript语句来执行。
>>> console.log(&#34;hello world&#34;) hello world >>> reg = new RegExp(&#34;hello&#34;) >>> console.log(reg) /hello/ >>> resp = reg.test(&#34;hello world&#34;) >>> console.log(resp) true 这个Javascript解释器内置了一个简单的http.Get方法，用于从一个url里面获取内容。
>>> var url = &#34;http://baidu.com&#34; >>> resp = http.Get(url) >>> console.log(resp) <html> <meta http-equiv=&#34;refresh&#34; content=&#34;0;url=http://www.baidu.com/&#34;> </html> 它甚至有自动补全功能，输入http.之后敲击<TAB>键，就可以补全出http.Get。重复按<TAB>可以在多个候选结果间切换。
按<Crtl+D>来退出Javascript解释器。
文件系统 #  eggos现在没有实现完整的文件系统，而是使用了 afero作为文件系统的抽象接口。
我们通过mount命令挂载一个samba文件系统来体验eggos的文件系统功能。
root@eggos# mount smb://icexin:eggos@172.28.90.3:445/sambashare /share root@eggos# cd /share root@eggos# ls -rw-rw-rw- 111 fib."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="1.2 体验eggos"><meta property="og:description" content="体验eggos #  上一节我们通过ISO镜像启动了eggos系统。
启动eggos成功后，我们就可以体验一些内置功能了。默认情况下有个类似linux的终端界面，在这个终端界面下我们可以输入命令来操作eggos。
这一节我们来体验下eggos的一些功能。
Javascript解释器 #  输入如下命令来启动交互式Javascript解释器
$ js 之后我们就可以输入合法的Javascript语句来执行。
>>> console.log(&#34;hello world&#34;) hello world >>> reg = new RegExp(&#34;hello&#34;) >>> console.log(reg) /hello/ >>> resp = reg.test(&#34;hello world&#34;) >>> console.log(resp) true 这个Javascript解释器内置了一个简单的http.Get方法，用于从一个url里面获取内容。
>>> var url = &#34;http://baidu.com&#34; >>> resp = http.Get(url) >>> console.log(resp) <html> <meta http-equiv=&#34;refresh&#34; content=&#34;0;url=http://www.baidu.com/&#34;> </html> 它甚至有自动补全功能，输入http.之后敲击<TAB>键，就可以补全出http.Get。重复按<TAB>可以在多个候选结果间切换。
按<Crtl+D>来退出Javascript解释器。
文件系统 #  eggos现在没有实现完整的文件系统，而是使用了 afero作为文件系统的抽象接口。
我们通过mount命令挂载一个samba文件系统来体验eggos的文件系统功能。
root@eggos# mount smb://icexin:eggos@172.28.90.3:445/sambashare /share root@eggos# cd /share root@eggos# ls -rw-rw-rw- 111 fib."><meta property="og:type" content="article"><meta property="og:url" content="https://eggos.icexin.com/docs/quick-start/play-eggos/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2021-07-04T02:43:40+08:00"><title>1.2 体验eggos | The book of eggos</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.958cea7827621d6fbcb3acf091344c3e44e3d2a9428f9c3c38bb9eb37bf8c45d.css integrity="sha256-lYzqeCdiHW+8s6zwkTRMPkTj0qlCj5w8OLues3v4xF0=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.c1e57f7927f41b163b324ff7269e8d0736d65e43a21e8351130144412c0f4262.js integrity="sha256-weV/eSf0GxY7Mk/3Jp6NBzbWXkOiHoNREwFEQSwPQmI=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-4S27LHKGHE','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-4S27LHKGHE"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-4S27LHKGHE',{anonymize_ip:!1})}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/><span>The book of eggos</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>第一章 快速开始</span><ul><li><a href=https://eggos.icexin.com/docs/quick-start/boot-from-cd/>1.1 从ISO镜像启动</a></li><li><a href=https://eggos.icexin.com/docs/quick-start/play-eggos/ class=active>1.2 体验eggos</a></li><li><a href=https://eggos.icexin.com/docs/quick-start/prepare-env/>1.3 搭建开发环境</a></li><li><a href=https://eggos.icexin.com/docs/quick-start/hello-eggos/>1.4 hello eggos</a></li></ul></li><li><span>第二章 Boot Loader</span><ul><li><a href=https://eggos.icexin.com/docs/boot-loader/grub/>2.1 使用grub</a></li></ul></li><li><span>第三章 最小化Go Runtime环境</span><ul></ul></li><li><span>第四章 线程与调度器</span><ul></ul></li><li><span>第五章 系统调用与中断</span><ul></ul></li><li><span>第六章 外设与驱动</span><ul></ul></li><li><span>第七章 网卡驱动与协议栈</span><ul></ul></li><li><span>第八章 用户程序</span><ul></ul></li></ul><ul><li><a href=https://icexin.com target=_blank rel=noopener>icexin的站点</a></li><li><a href=https://github.com/icexin/eggos target=_blank rel=noopener>eggos源码</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>1.2 体验eggos</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#体验eggos>体验eggos</a><ul><li><a href=#javascript解释器>Javascript解释器</a></li><li><a href=#文件系统>文件系统</a></li><li><a href=#http服务>HTTP服务</a></li><li><a href=#nes模拟器>NES模拟器</a></li></ul></li><li><a href=#小结>小结</a></li><li><a href=#扩展阅读>扩展阅读</a></li></ul></nav></aside></header><article class=markdown><h1 id=体验eggos>体验eggos
<a class=anchor href=#%e4%bd%93%e9%aa%8ceggos>#</a></h1><p>上一节我们通过ISO镜像启动了eggos系统。</p><p>启动<code>eggos</code>成功后，我们就可以体验一些内置功能了。默认情况下有个类似linux的终端界面，在这个终端界面下我们可以输入命令来操作<code>eggos</code>。</p><p>这一节我们来体验下<code>eggos</code>的一些功能。</p><h2 id=javascript解释器>Javascript解释器
<a class=anchor href=#javascript%e8%a7%a3%e9%87%8a%e5%99%a8>#</a></h2><p>输入如下命令来启动交互式Javascript解释器</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ js
</code></pre></div><p>之后我们就可以输入合法的Javascript语句来执行。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Js data-lang=Js><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;hello world&#34;</span>)
<span style=color:#a6e22e>hello</span> <span style=color:#a6e22e>world</span>
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>reg</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RegExp(<span style=color:#e6db74>&#34;hello&#34;</span>)
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>reg</span>)
<span style=color:#e6db74>/hello/</span>
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>resp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>reg</span>.<span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;hello world&#34;</span>)
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>resp</span>)
<span style=color:#66d9ef>true</span>
</code></pre></div><p>这个Javascript解释器内置了一个简单的<code>http.Get</code>方法，用于从一个url里面获取内容。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Js data-lang=Js><span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://baidu.com&#34;</span>
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>resp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>url</span>)
<span style=color:#f92672>&gt;&gt;&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>resp</span>)
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>html</span><span style=color:#f92672>&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>meta</span> <span style=color:#a6e22e>http</span><span style=color:#f92672>-</span><span style=color:#a6e22e>equiv</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;refresh&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0;url=http://www.baidu.com/&#34;</span><span style=color:#f92672>&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/html&gt;</span>
</code></pre></div><p>它甚至有自动补全功能，输入<code>http.</code>之后敲击<code>&lt;TAB></code>键，就可以补全出<code>http.Get</code>。重复按<code>&lt;TAB></code>可以在多个候选结果间切换。</p><p>按<code>&lt;Crtl+D></code>来退出Javascript解释器。</p><h2 id=文件系统>文件系统
<a class=anchor href=#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f>#</a></h2><p><code>eggos</code>现在没有实现完整的文件系统，而是使用了
<a href=https://github.com/spf13/afero>afero</a>作为文件系统的抽象接口。</p><p>我们通过<code>mount</code>命令挂载一个<code>samba</code>文件系统来体验<code>eggos</code>的文件系统功能。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>root@eggos# mount smb://icexin:eggos@172.28.90.3:445/sambashare /share
root@eggos# cd /share
root@eggos# ls
-rw-rw-rw- <span style=color:#ae81ff>111</span> fib.js
root@eggos# cat fib.js
<span style=color:#66d9ef>function</span> fib<span style=color:#f92672>(</span>n<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>n <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> n <span style=color:#f92672>==</span> 2<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
                <span style=color:#66d9ef>return</span> 1;
        <span style=color:#f92672>}</span>
        <span style=color:#66d9ef>return</span> fib<span style=color:#f92672>(</span>n-1<span style=color:#f92672>)</span> + fib<span style=color:#f92672>(</span>n-2<span style=color:#f92672>)</span>;
<span style=color:#f92672>}</span>

console.log<span style=color:#f92672>(</span>fib<span style=color:#f92672>(</span>10<span style=color:#f92672>))</span>

root@eggos# js fib.js
<span style=color:#ae81ff>55</span>

</code></pre></div><p>解释一下上面我们做了什么：</p><p>首先我们通过mount命令将一个samba地址挂载到了本地的一个目录</p><ul><li><code>mount</code>的第一个参数是源地址URI，第二个参数是本地的挂载点，这里是<code>/share</code></li><li>源地址URI符合标准的URI格式，其中<code>smb</code>代表我们使用的是<code>samba</code>协议</li><li><code>icexin</code>和<code>eggos</code>分别是samba的账号和密码，读者需要替换成自己的账号和密码</li><li><code>172.28.90.3:445</code>为samba服务器的ip和端口，读者需要替换成自己的ip和端口</li></ul><p>接着我们使用<code>cd</code>和<code>ls</code>命令切换到<code>/share</code>目录，并列出目录下的文件，目录下有一个<code>fib.js</code>。</p><p>然后我们使用<code>cat</code>命令打印出<code>fib.js</code>文件的内容，里面使用Javascript实现了斐波那契数列算法，并打印出第10个斐波那契数。</p><p>最后我们执行<code>js</code>命令，用<code>fib.js</code>作为参数，效果是执行了<code>fib.js</code>里面的Javascript代码，打印出结果<code>55</code>。</p><h2 id=http服务>HTTP服务
<a class=anchor href=#http%e6%9c%8d%e5%8a%a1>#</a></h2><p><code>eggos</code>内置了一个简单的http服务器，使用<code>go httpd</code>命令即可后台启动HTTP服务器。
这个服务器默认绑定了两个地址：</p><ul><li><code>/debug/pprof</code>，go著名的pprof地址，里面可以查看很多当前go进程的debug信息</li><li><code>/fs/</code>，根目录的映射，可以从浏览器访问整个文件系统。</li></ul><p>打开浏览器，输入<code>http://127.0.0.1:8080/debug/pprof/</code>，即可打开debug页面，从里面我们可以获取当前运行的goroutine堆栈快照。</p><p><img src=/images/http-pprof.png alt="http pprof信息"></p><p>输入<code>http://127.0.0.1:8080/fs/</code>即可访问文件系统根目录，从里面我们可以发现刚刚挂载的<code>/share</code>目录。</p><p><img src=/images/fib-js.png alt=fib.js的内容></p><p>一路点进去之后我们就能访问<code>/share/fib.js</code>的内容。</p><blockquote class="book-hint info">很遗憾的是目前<code>httpd</code>一旦启动就没办法停止，只能重新启动eggos来停止服务</blockquote><h2 id=nes模拟器>NES模拟器
<a class=anchor href=#nes%e6%a8%a1%e6%8b%9f%e5%99%a8>#</a></h2><blockquote class="book-hint warning">本小节必须在图形界面下运行qemu</blockquote><p><code>eggos</code>内置了一个nes模拟器，也就是我们小时候玩的小霸王游戏机模拟器，可以运行一些简单的任天堂FC游戏。</p><p>接着文件系统那一节的内容，我们这次需要在共享文件夹里面准备一个nes rom。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>root@eggos#  mount smb://icexin:eggos@172.28.90.3:445/sambashare /share
root@eggos# ls /share
-rw-rw-rw- <span style=color:#ae81ff>111</span>   fib.js
-rw-rw-rw- <span style=color:#ae81ff>40976</span> mario.nes
</code></pre></div><p>相比于之前，多了一个<code>mario.nes</code>文件，这个就是我们即将运行的<code>超级马里奥兄弟</code>游戏。</p><p>执行如下命令即可启动nes模拟器，其中<code>-rom</code>参数指定待运行的rom文件。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>root@eggos# nes -rom /share/mario.nes
</code></pre></div><p>如果一切成功的话，可以看到如下画面</p><p><img src=/images/nes-mario.png alt=nes-mario></p><p>操作按键是固定的，分别如下:</p><ul><li><code>W</code>, <code>S</code>, <code>A</code>, <code>D</code>控制手柄的上下左右</li><li><code>K</code>, <code>J</code>控制手柄的<code>A</code>和<code>B</code></li><li>空格和回车控制手柄的选择和开始</li><li><code>Q</code>键可以退出游戏</li></ul><blockquote class="book-hint info">如果不开启模拟器加速的话，运行会比较卡，MacOS用户可以通过在启动qemu的时候添加<code>-M accel=hvf</code>开启硬件加速，linux用户可以添加<code>-M accel=kvm</code>来启动加速。</blockquote><h1 id=小结>小结
<a class=anchor href=#%e5%b0%8f%e7%bb%93>#</a></h1><p>通过Javascript解释器，文件系统，HTTP服务，NES模拟器这几个应用我们对eggos有了初步的认识，下面章节我们开始搭建eggos开发环境，编写自己的eggos应用。</p><h1 id=扩展阅读>扩展阅读
<a class=anchor href=#%e6%89%a9%e5%b1%95%e9%98%85%e8%af%bb>#</a></h1><ul><li>[1] A JavaScript interpreter in Go <a href=https://github.com/robertkrimen/otto>https://github.com/robertkrimen/otto</a></li><li>[2] Ubuntu上安装samba服务 <a href=https://ubuntu.com/tutorials/install-and-configure-samba>https://ubuntu.com/tutorials/install-and-configure-samba</a></li><li>[3] NES emulator written in Go <a href=https://github.com/fogleman/nes>https://github.com/fogleman/nes</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/icexin/eggos-book/commit/00bd34651df67e1edb909d556207304356a66e69 title="Last modified by icexin | July 3, 2021" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 3, 2021</span></a></div><div><a class="flex align-center" href=https://github.com/icexin/eggos-book/edit/main/content/docs/quick-start/play-eggos.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://utteranc.es/client.js repo=icexin/doc-comments issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#体验eggos>体验eggos</a><ul><li><a href=#javascript解释器>Javascript解释器</a></li><li><a href=#文件系统>文件系统</a></li><li><a href=#http服务>HTTP服务</a></li><li><a href=#nes模拟器>NES模拟器</a></li></ul></li><li><a href=#小结>小结</a></li><li><a href=#扩展阅读>扩展阅读</a></li></ul></nav></div></aside></main></body></html>